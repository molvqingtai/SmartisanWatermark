{"id":"FVPG","dependencies":[{"name":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/.babelrc","includedInParent":true,"mtime":1539021763600},{"name":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/package.json","includedInParent":true,"mtime":1539099601665},{"name":"blob-polyfill","loc":{"line":1,"column":7},"parent":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/src/assets/js/main.js","resolved":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/node_modules/blob-polyfill/Blob.js"},{"name":"materialize-css","loc":{"line":2,"column":14},"parent":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/src/assets/js/main.js","resolved":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/node_modules/materialize-css/dist/js/materialize.js"},{"name":"exif-js","loc":{"line":3,"column":17},"parent":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/src/assets/js/main.js","resolved":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/node_modules/exif-js/exif.js"},{"name":"tinycolor2","loc":{"line":4,"column":22},"parent":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/src/assets/js/main.js","resolved":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/node_modules/tinycolor2/tinycolor.js"},{"name":"color-thief","loc":{"line":5,"column":23},"parent":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/src/assets/js/main.js","resolved":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/node_modules/color-thief/js/color-thief.js"}],"generated":{"js":"\"use strict\";require(\"blob-polyfill\");var e=i(require(\"materialize-css\")),t=i(require(\"exif-js\")),n=i(require(\"tinycolor2\")),l=i(require(\"color-thief\"));function i(e){return e&&e.__esModule?e:{default:e}}!function(i){var a=document.querySelector(\"#display-img\"),r=document.querySelector(\"#upload-img\"),o=document.querySelector(\"#download-btn\"),c=document.querySelector(\"#icons-btn\");r.addEventListener(\"change\",function(e){u(e.target.files[0])}),a.addEventListener(\"click\",function(e){e.preventDefault(),h(e.currentTarget)}),a.addEventListener(\"touch\",function(e){e.preventDefault(),h(e.currentTarget)});var u=function(e){e&&(/image\\/\\w+/.test(e.type)?d(e).then(function(t){if(Object.keys(t).length>0&&t.Make&&t.Make.includes(\"Smartisan\")){var n=new FileReader;n.onload=function(n){f(\"start\"),s(t,n.target.result).then(function(t){var n=e.name.slice(0,e.name.lastIndexOf(\".\"))+\".jpeg\";f(\"end\",{url:t,name:n})},function(e){g(\"照片EXIF信息错误!\"),f(\"error\")})},n.readAsDataURL(e)}else g(\"请上传Smartisan相机照片!\")}):g(\"照片格式错误!\"))},s=function(e,t){var n=document.createElement(\"canvas\"),l=n.getContext(\"2d\"),i=new Image,a=e.ImageWidth,r=e.ImageHeight,o=.02*e.ImageWidth,c=.02*e.ImageHeight,u=.96*e.ImageWidth,s=.96*e.ImageHeight,d=.04*e.ImageWidth,f=1.04*e.ImageHeight;return n.width=e.ImageWidth,n.height=e.ImageHeight+.12*e.ImageHeight,new Promise(function(g,h){i.onload=function(){document.fonts.load(\"100px Smartisan\").then(function(){m(i).then(function(t){i.transform(),l.fillStyle=\"#FFFFFF\",l.fillRect(0,0,n.width,n.height),l.drawImage(i,0,0,a,r,o,c,u,s),l.font=\"700 100px sans-serif,Smartisan\",l.fillStyle=t,l.fillText(\"  Shot on \".concat(e.Model),d,f),n.toBlob(function(e){try{g(URL.createObjectURL(e))}catch(t){h(t)}},\"image/jpeg\",1)})})},i.src=t})},d=function(e){return new Promise(function(n,l){t.default.getData(e,function(){n(t.default.getAllTags(this))})})},m=function(e){return new Promise(function(t,i){var a=new l.default,r=a.getPalette(e,10);r.unshift(a.getColor(e)),r.forEach(function(e){var l=\"rgb(\".concat(e[0],\",\").concat(e[1],\",\").concat(e[2],\")\");(0,n.default)(l).isDark()?t(l):t(\"rgb(102, 102, 102)\")})})},f=function(e,t){switch(e){case\"start\":c.firstElementChild.style.display=\"block\",c.lastElementChild.style.display=\"none\",o.innerHTML=\"生成水印中...\",o.href=\"javascript::void(0);\";break;case\"end\":a.src=o.href=t.url,a.onload=function(){o.download=t.name,c.firstElementChild.style.display=\"none\",c.lastElementChild.style.display=\"block\",o.innerHTML='下载水印照片<i class=\"material-icons\">file_download</i>',o.removeAttribute(\"disabled\")};break;case\"error\":c.firstElementChild.style.display=\"none\",c.lastElementChild.style.display=\"block\",o.innerHTML='下载水印照片<i class=\"material-icons\">file_download</i>',o.setAttribute(\"disabled\",\"disabled\")}},g=function(t){r.value=\"\",e.default.toast({html:t,displayLength:3e3,classes:\"rounded\"})},h=function(e){document.fullscreen||document.webkitIsFullScreen||document.mozFullScreen?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen&&document.mozCancelFullScreen():e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullScreen?i.navigator.userAgent.toUpperCase().indexOf(\"CHROME\")>=0?e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):e.webkitRequestFullScreen():e.mozRequestFullScreen&&e.mozRequestFullScreen()}}(window);","map":null},"hash":"9706f83a69060f269693df5eb1821c02","cacheData":{"env":{}}}