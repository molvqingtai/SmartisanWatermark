{"id":"FVPG","dependencies":[{"name":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/.babelrc","includedInParent":true,"mtime":1539021763600},{"name":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/package.json","includedInParent":true,"mtime":1539066410900},{"name":"blob-polyfill","loc":{"line":1,"column":7},"parent":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/src/assets/js/main.js","resolved":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/node_modules/blob-polyfill/Blob.js"},{"name":"materialize-css","loc":{"line":2,"column":14},"parent":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/src/assets/js/main.js","resolved":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/node_modules/materialize-css/dist/js/materialize.js"},{"name":"exif-js","loc":{"line":3,"column":17},"parent":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/src/assets/js/main.js","resolved":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/node_modules/exif-js/exif.js"},{"name":"tinycolor2","loc":{"line":4,"column":22},"parent":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/src/assets/js/main.js","resolved":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/node_modules/tinycolor2/tinycolor.js"},{"name":"color-thief","loc":{"line":5,"column":23},"parent":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/src/assets/js/main.js","resolved":"/Users/molvqingtai/Desktop/project/SmartisanWatermark/node_modules/color-thief/js/color-thief.js"}],"generated":{"js":"\"use strict\";require(\"blob-polyfill\");var e=l(require(\"materialize-css\")),n=l(require(\"exif-js\")),t=l(require(\"tinycolor2\")),i=l(require(\"color-thief\"));function l(e){return e&&e.__esModule?e:{default:e}}!function(){var l=document.querySelector(\"#display-img\"),o=document.querySelector(\"#upload-img\"),r=document.querySelector(\"#download-btn\"),a=document.querySelector(\"#icons-btn\");o.addEventListener(\"change\",function(e){c(e.target.files[0])}),l.addEventListener(\"click\",function(e){e.preventDefault(),h(e.currentTarget)}),l.addEventListener(\"touch\",function(e){e.preventDefault(),h(e.currentTarget)});var c=function(e){e&&(/image\\/\\w+/.test(e.type)?u(e).then(function(n){if(Object.keys(n).length>0&&n.Make&&n.Make.includes(\"Smartisan\")){var t=new FileReader;t.onload=function(t){m(\"start\"),s(n,t.target.result).then(function(n){var t=e.name.slice(0,e.name.lastIndexOf(\".\"))+\".jpeg\";m(\"end\",{url:n,name:t})},function(e){f(\"照片EXIF信息错误!\"),m(\"error\")})},t.readAsDataURL(e)}else f(\"请上传Smartisan相机照片!\")}):f(\"照片格式错误!\"))},s=function(e,n){var t=document.createElement(\"canvas\"),i=t.getContext(\"2d\"),l=new Image,o=e.PixelXDimension,r=e.PixelYDimension,a=.02*e.PixelXDimension,c=.02*e.PixelYDimension,s=.96*e.PixelXDimension,u=.96*e.PixelYDimension,m=.04*e.PixelXDimension,f=1.04*e.PixelYDimension;return t.width=e.PixelXDimension,t.height=e.PixelYDimension+.12*e.PixelYDimension,new Promise(function(h,g){l.onload=function(){document.fonts.load(\"100px Smartisan\").then(function(){d(l).then(function(n){i.fillStyle=\"#FFFFFF\",i.fillRect(0,0,t.width,t.height),i.drawImage(l,0,0,o,r,a,c,s,u),i.font=\"700 100px sans-serif,Smartisan\",i.fillStyle=n,i.fillText(\"  Shot on \".concat(e.Model),m,f),t.toBlob(function(e){try{h(URL.createObjectURL(e))}catch(n){g(n)}},\"image/jpeg\",1)})})},l.src=n})},u=function(e){return new Promise(function(t,i){n.default.getData(e,function(){t(n.default.getAllTags(this))})})},d=function(e){return new Promise(function(n,l){var o=new i.default,r=o.getPalette(e,10);r.unshift(o.getColor(e)),r.forEach(function(e){var i=\"rgb(\".concat(e[0],\",\").concat(e[1],\",\").concat(e[2],\")\");(0,t.default)(i).isDark()?n(i):n(\"rgb(102, 102, 102)\")})})},m=function(e,n){switch(e){case\"start\":a.firstElementChild.style.display=\"block\",a.lastElementChild.style.display=\"none\",r.innerHTML=\"生成水印中...\",r.href=\"javascript::void(0);\";break;case\"end\":l.src=r.href=n.url,l.onload=function(){r.download=n.name,a.firstElementChild.style.display=\"none\",a.lastElementChild.style.display=\"block\",r.innerHTML='下载水印照片<i class=\"material-icons\">file_download</i>',r.removeAttribute(\"disabled\")};break;case\"error\":a.firstElementChild.style.display=\"none\",a.lastElementChild.style.display=\"block\",r.innerHTML='下载水印照片<i class=\"material-icons\">file_download</i>',r.setAttribute(\"disabled\",\"disabled\")}},f=function(n){o.value=\"\",e.default.toast({html:n,displayLength:3e3,classes:\"rounded\"})},h=function(e){document.fullscreen||document.webkitIsFullScreen||document.mozFullScreen?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen&&document.mozCancelFullScreen():e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullScreen?window.navigator.userAgent.toUpperCase().indexOf(\"CHROME\")>=0?e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):e.webkitRequestFullScreen():e.mozRequestFullScreen&&e.mozRequestFullScreen()}}(window);","map":null},"hash":"e3de5c3fcaf2ad781839962e5c92321c","cacheData":{"env":{}}}